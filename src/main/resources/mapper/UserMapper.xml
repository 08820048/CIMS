<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.edu.hzvtc.dao.UserMapper">
  <resultMap id="BaseResultMap" type="cn.edu.hzvtc.pojo.User">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Sep 13 10:19:43 CST 2021.
    -->
    <id column="id" jdbcType="INTEGER" property="id" />
    <result column="user_name" jdbcType="VARCHAR" property="userName" />
    <result column="user_password" jdbcType="VARCHAR" property="userPassword" />
    <result column="user_operator_id" jdbcType="INTEGER" property="userOperatorId" />
    <result column="user_operator_time" jdbcType="TIMESTAMP" property="userOperatorTime" />
    <result column="user_type" jdbcType="INTEGER" property="userType" />
    <result column="user_area_id" jdbcType="INTEGER" property="userAreaId" />
      <result column="user_del_state" jdbcType="INTEGER" property="userDelState"/>
      <discriminator javaType="INTEGER" column="user_type">
          <case value="2">
              <association property="area" select="cn.edu.hzvtc.dao.AreaMapper.selectByPrimaryKey"
                           column="user_area_id"/>
          </case>
          <case value="3">
              <association property="area" select="cn.edu.hzvtc.dao.AreaMapper.selectByPrimaryKey"
                           column="user_area_id"/>
          </case>
      </discriminator>
  </resultMap>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Sep 13 10:19:43 CST 2021.
    -->
    delete from sys_user
    where id = #{id,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="cn.edu.hzvtc.pojo.User">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Sep 13 10:19:43 CST 2021.
    -->
    insert into sys_user (id, user_name, user_password, 
      user_operator_id, user_operator_time, user_type, 
      user_area_id)
    values (#{id,jdbcType=INTEGER}, #{userName,jdbcType=VARCHAR}, #{userPassword,jdbcType=VARCHAR}, 
      #{userOperatorId,jdbcType=INTEGER}, #{userOperatorTime,jdbcType=TIMESTAMP}, #{userType,jdbcType=INTEGER}, 
      #{userAreaId,jdbcType=INTEGER})
  </insert>
  <update id="updateByPrimaryKey" parameterType="cn.edu.hzvtc.pojo.User">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Sep 13 10:19:43 CST 2021.
    -->
    update sys_user
    set user_name = #{userName,jdbcType=VARCHAR},
      user_password = #{userPassword,jdbcType=VARCHAR},
      user_operator_id = #{userOperatorId,jdbcType=INTEGER},
      user_operator_time = #{userOperatorTime,jdbcType=TIMESTAMP},
      user_type = #{userType,jdbcType=INTEGER},
      user_area_id = #{userAreaId,jdbcType=INTEGER}
    where id = #{id,jdbcType=INTEGER}
  </update>
  <select id="selectByPrimaryKey" parameterType="java.lang.Integer" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Sep 13 10:19:43 CST 2021.
    -->
    select id, user_name, user_password, user_operator_id, user_operator_time, user_type, 
    user_area_id
    from sys_user
    where id = #{id,jdbcType=INTEGER}
  </select>
  <select id="selectAll" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Sep 13 10:19:43 CST 2021.
    -->
    select id, user_name, user_password, user_operator_id, user_operator_time, user_type, 
    user_area_id
    from sys_user
  </select>
<!--    <select id="login" parameterType="cn.edu.hzvtc.pojo.User" resultType="cn.edu.hzvtc.pojo.User">-->
<!--    select *-->
<!--    from sys_user-->
<!--    where user_name = #{param1} and user_passWord = #{param2}-->
<!--</select>-->
    <select id="login" parameterType="cn.edu.hzvtc.pojo.User" resultType="cn.edu.hzvtc.pojo.User">
SELECT sys_user.id,sys_user.user_name,sys_user.user_type,sa_prov.area_name as parentArea,sa_city.area_name as parentAreaa,sys_area.area_name as areaName,msg_info.msg_title,unit_info.unit_name,unit_type.unit_type_name
FROM sys_user
LEFT JOIN sys_area ON sys_user.user_area_id = sys_area.id
LEFT JOIN msg_info ON sys_user.id = msg_info.msg_send_user_id
LEFT JOIN sys_user_unit ON sys_user.id=sys_user_unit.user_id
LEFT JOIN unit_info ON unit_info.id=sys_user_unit.unit_id
LEFT JOIN unit_type ON unit_info.unit_type_id=unit_type.id
LEFT JOIN sys_area sa_city ON sys_area.area_parent_id=sa_city.id
LEFT JOIN sys_area sa_prov ON sa_city.area_parent_id=sa_prov.id
where user_name = #{param1} and user_passWord = #{param2}
</select>
</mapper>